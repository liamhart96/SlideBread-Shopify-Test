var G=Object.defineProperty;var M=(g,l,e)=>l in g?G(g,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[l]=e;var y=(g,l,e)=>M(g,typeof l!="symbol"?l+"":l,e);import"./modulepreload-polyfill.B5Qt9EMX.min.js";import{B as z,F as k,R as C,c as x,a as T}from"./CartService.DjU9-j2s.min.js";import{j as n,r as f,c as A,t as v}from"./bundle-mjs.DY7OEoBL.min.js";const p=class p extends z{constructor(e){super(e,{prevNextButtons:!0,pageDots:!1,imagesLoaded:!0,cellAlign:"left",contain:!0,groupCells:"100%"});y(this,"modal",null);y(this,"mainGallery",null);y(this,"navGallery",null);y(this,"originalImages",[]);y(this,"currentImages",[]);this.storeOriginalImages(),this.initializeGalleries(),this.initializeModal(),this.initializeVariantListener(),window.addEventListener("beforeunload",()=>this.destroy())}storeOriginalImages(){const e=document.querySelectorAll(".product-gallery-carousel-main img");this.originalImages=Array.from(e).map(r=>({src:r.src,alt:r.alt,width:r.width,height:r.height})),this.currentImages=[...this.originalImages]}initializeVariantListener(){document.addEventListener("variant:changed",e=>{const r=e,{variant:a}=r.detail;console.log("Variant changed:",a),a.images&&a.images.length>0?(console.log("Updating gallery with variant images:",a.images),this.updateGalleryImages(a.images)):console.log("No variant images, keeping original gallery")}),document.addEventListener("gallery:updateImages",e=>{const r=e,{images:a}=r.detail;a&&a.length>0&&(console.log("Updating gallery with custom images:",a),this.updateGalleryImages(a))})}updateGalleryImages(e){const r=e.filter(t=>t&&t.trim()!==""&&t!=="null"&&t!=="undefined");if(r.length===0){console.warn("No valid image URLs provided for variant, keeping original gallery");return}const a=r.map((t,o)=>({src:t,alt:`Product image ${o+1}`,width:800,height:800}));console.log("Updating gallery with images:",a),this.currentImages=a,this.refreshGalleryWithImages(a)}resetToOriginalImages(){this.currentImages=[...this.originalImages],this.refreshGalleryWithImages(this.originalImages)}refreshGalleryWithImages(e){if(!e||e.length===0){console.warn("No images provided for variant, keeping current gallery");return}const r=e.filter(a=>a.src&&a.src.trim()!=="");if(r.length===0){console.warn("No valid images found for variant, keeping current gallery");return}try{this.updateCarouselImages(".product-gallery-carousel-main",r,"large"),this.updateCarouselImages(".product-gallery-carousel-nav",r,"small"),this.updateCarouselImages(".gallery-modal-carousel",r,"2048x"),setTimeout(()=>{if(this.mainGallery)try{this.mainGallery.reloadCells(),this.mainGallery.select(0)}catch(a){console.warn("Error reloading main gallery:",a)}if(this.navGallery)try{this.navGallery.reloadCells(),this.navGallery.select(0)}catch(a){console.warn("Error reloading nav gallery:",a)}},100)}catch(a){console.error("Error updating gallery images:",a),this.resetToOriginalImages()}}updateCarouselImages(e,r,a){const t=document.querySelector(e);if(!t){console.warn(`Carousel element not found: ${e}`);return}const o=t.innerHTML;try{t.innerHTML="",r.forEach((u,m)=>{if(!u.src||u.src.trim()===""){console.warn(`Skipping invalid image at index ${m}`);return}const c=document.createElement("div");c.className="carousel-cell",e===".product-gallery-carousel-main"?c.className+=" group relative w-full overflow-hidden md:rounded-lg":e===".product-gallery-carousel-nav"&&(c.className+=" overflow-hidden rounded-lg");const i=this.getImageUrl(u.src,a),s=document.createElement("img");s.src=i,s.alt=u.alt||`Product image ${m+1}`,s.width=u.width||800,s.height=u.height||800,s.className="h-full w-full object-cover",s.loading=m===0?"eager":"lazy",s.onerror=()=>{console.warn(`Failed to load image: ${i}`),c.style.display="none"},c.appendChild(s),e===".product-gallery-carousel-main"&&this.addGalleryButtons(c),t.appendChild(c)}),t.children.length===0&&(console.warn("No valid images to display, restoring original content"),t.innerHTML=o)}catch(u){console.error(`Error updating carousel ${e}:`,u),t.innerHTML=o}}addGalleryButtons(e){const r=document.createElement("button");r.className="gallery-zoom-button absolute bottom-16 right-4 flex cursor-pointer items-center justify-center rounded-full bg-white/50 p-2 transition-colors duration-200 hover:bg-white/70",r.setAttribute("aria-label","Enlarge image"),r.innerHTML=`<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
    </svg>`;const a=document.createElement("button");a.className="absolute bottom-4 right-4 flex cursor-pointer items-center justify-center rounded-full bg-white/50 p-2 transition-colors duration-200 hover:bg-white/70",a.setAttribute("aria-label","Add to favorites"),a.innerHTML=`<svg class="w-5 h-5 text-red-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
    </svg>`,e.appendChild(r),e.appendChild(a),r.addEventListener("click",()=>{var t;(t=this.modal)==null||t.showModal(),this.init(),this.mainGallery&&this.select(this.mainGallery.selectedIndex)})}getImageUrl(e,r){return e.includes("shopify")?`${e.split("?")[0]}?width=${this.getSizePixels(r)}`:e}getSizePixels(e){return{small:200,medium:400,large:800,"2048x":2048}[e]||800}initializeGalleries(){const e=document.querySelector(".product-gallery-carousel-nav");if(!e)return;this.navGallery=new k(e,{asNavFor:".product-gallery-carousel-main",pageDots:!1,groupCells:"100%",cellAlign:"left"});const r=document.querySelector(".product-gallery-carousel-main");r&&(this.mainGallery=new k(r,{prevNextButtons:!1,pageDots:!0,cellAlign:"left"}))}initializeModal(){if(this.modal=document.querySelector(".gallery-modal"),!this.modal)return;document.addEventListener("click",r=>{var a;r.target.closest(".gallery-zoom-button")&&((a=this.modal)==null||a.showModal(),this.init(),this.mainGallery&&this.select(this.mainGallery.selectedIndex))});const e=this.modal.querySelector(".gallery-modal-close");e==null||e.addEventListener("click",()=>{var r;(r=this.modal)==null||r.close(),this.destroy()}),this.modal.addEventListener("close",()=>{this.destroy()})}updateImages(e){this.updateGalleryImages(e)}getCurrentImages(){return this.currentImages}static initialize(e){return p.instance||(p.instance=new p(e)),p.instance}destroy(){this.mainGallery&&(this.mainGallery.destroy(),this.mainGallery=null),this.navGallery&&(this.navGallery.destroy(),this.navGallery=null),super.destroy()}};y(p,"instance");let j=p;function L({variantId:g,available:l}){const[e,r]=f.useState(1),[a,t]=f.useState(""),[o,u]=f.useState(!1),[m,c]=f.useState(x.isLoading());f.useEffect(()=>{const s=x.subscribe("cart:loading",h=>{c(h.loading)}),d=x.subscribe("cart:error",h=>{t(h.message)});return()=>{s(),d()}},[]);const i=async s=>{if(s.preventDefault(),!l){t("This product is currently unavailable");return}u(!0),t("");const d=await x.addItems([{id:g,quantity:e}]);!d.success&&d.error?t(d.error):T.openCart(),u(!1)};return n.jsxs("div",{children:[n.jsx("form",{onSubmit:i,className:"space-y-4",children:n.jsx("button",{type:"submit",disabled:o||m||!l,className:`btn w-full ${l?"btn-secondary":"btn-secondary cursor-not-allowed"}`,children:o||m?"Adding...":l?"Add to Bag":"Sold Out"})}),a&&n.jsx("div",{className:"mt-2 text-sm text-red-600",children:a})]})}class N extends C{constructor(){super();y(this,"_handleVariantChange");this._handleVariantChange=e=>{const r=e,{variantId:a,variant:t}=r.detail;this.setAttribute("data-variant-id",a.toString()),this.setAttribute("data-available",t.available.toString()),this.renderReact(n.jsx(L,{variantId:a,available:t.available}))}}connectedCallback(){super.connectedCallback();const e=Number.parseInt(this.getAttribute("data-variant-id")||"0",10),r=this.getAttribute("data-available")==="true";document.addEventListener("variant:changed",this._handleVariantChange),this.renderReact(n.jsx(L,{variantId:e,available:r}))}disconnectedCallback(){document.removeEventListener("variant:changed",this._handleVariantChange),super.disconnectedCallback()}}y(N,"elementName","add-to-cart");customElements.define(N.elementName,N);function O({endDate:g}){const[l,e]=f.useState(()=>{const a=new Date(g).getTime(),t=new Date().getTime(),o=a-t;return o<0?{days:0,hours:0,minutes:0,seconds:0}:{days:Math.floor(o/864e5),hours:Math.floor(o%864e5/36e5),minutes:Math.floor(o%36e5/6e4),seconds:Math.floor(o%6e4/1e3)}});f.useEffect(()=>{const a=()=>{const u=new Date(g).getTime(),m=new Date().getTime(),c=u-m;return c<0?null:{days:Math.floor(c/864e5),hours:Math.floor(c%864e5/36e5),minutes:Math.floor(c%36e5/6e4),seconds:Math.floor(c%6e4/1e3)}},t=a();t&&e(t);const o=setInterval(()=>{const u=a();if(!u){clearInterval(o);return}e(u)},1e3);return()=>clearInterval(o)},[g]);const r=a=>a.toString().padStart(2,"0");return n.jsxs("div",{children:[n.jsx("div",{className:"mb-3 text-center font-medium",children:"Limited time offer:"}),n.jsxs("div",{className:"flex justify-center space-x-4",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("span",{className:"text-2xl font-bold",children:r(l.days)}),n.jsx("span",{className:"text-xs text-gray-500",children:"Days"})]}),n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("span",{className:"text-2xl font-bold",children:r(l.hours)}),n.jsx("span",{className:"text-xs text-gray-500",children:"Hours"})]}),n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("span",{className:"text-2xl font-bold",children:r(l.minutes)}),n.jsx("span",{className:"text-xs text-gray-500",children:"Minutes"})]}),n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("span",{className:"text-2xl font-bold",children:r(l.seconds)}),n.jsx("span",{className:"text-xs text-gray-500",children:"Seconds"})]})]})]})}class B extends HTMLElement{constructor(){super(...arguments);y(this,"root",null)}disconnectedCallback(){this.root&&this.root.unmount()}connectedCallback(){const e=this.getAttribute("end-date");if(!e)return;const r=document.createElement("div");this.appendChild(r),this.root=A.createRoot(r),this.root.render(n.jsx(O,{endDate:e}))}}customElements.define("countdown-timer",B);function U({label:g,selectedValue:l,options:e,onSelect:r,className:a}){const[t,o]=f.useState(!1),u=f.useRef(null);return f.useEffect(()=>{const m=c=>{u.current&&!u.current.contains(c.target)&&o(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),n.jsxs("div",{className:v("relative flex items-center gap-2",a),ref:u,children:[n.jsx("label",{className:"block font-bold",children:g}),n.jsxs("button",{type:"button",onClick:()=>o(!t),className:"focus:border-primary focus:ring-primary flex w-fit items-center justify-between rounded-lg border border-gray-300 bg-white px-4 py-3 text-left shadow-sm hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-opacity-20",children:[n.jsx("span",{className:"text-base font-bold",children:l}),n.jsx("svg",{className:v("h-5 w-5 text-gray-400 transition-transform",t?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&n.jsx("div",{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md border border-gray-200 bg-white shadow-lg",children:n.jsx("div",{className:"py-1",children:e.map(m=>n.jsx("button",{type:"button",onClick:()=>{r(m),o(!1)},className:v("w-full px-4 py-2 text-left text-sm hover:bg-gray-50 focus:bg-gray-50 focus:outline-none",m===l?"bg-primary text-primary bg-opacity-10 font-medium":"text-gray-900"),children:m},m))})})]})}function R({label:g,selectedValue:l,options:e,onSelect:r,className:a,colorConfig:t}){var c,i;console.log("ColorSelector - colorConfig:",t),console.log("ColorSelector - selectedValue:",l),console.log("ColorSelector - display name:",(c=t==null?void 0:t[l])==null?void 0:c.name);const o=s=>{if(t&&t[s]){const b=t[s];if(b.hex)return`bg-[${b.hex}]`;if(b.image)return"bg-cover bg-center"}const d={black:"bg-black",white:"bg-white border-gray-300",red:"bg-red-500",blue:"bg-blue-500",green:"bg-green-500",yellow:"bg-yellow-500",purple:"bg-purple-500",pink:"bg-pink-500",gray:"bg-gray-500",grey:"bg-gray-500",brown:"bg-amber-700",orange:"bg-orange-500",navy:"bg-navy-900",beige:"bg-amber-100",tan:"bg-yellow-600",silver:"bg-gray-300",gold:"bg-yellow-400"},h=s.toLowerCase();return d[h]||"bg-gray-400"},u=s=>{if(t&&t[s]){const d=t[s];if(d.image)return{backgroundImage:`url(${d.image})`,backgroundSize:"cover",backgroundPosition:"center"};if(d.hex)return{backgroundColor:d.hex}}return{}},m=s=>!!(t&&t[s]&&(t[s].hex||t[s].image));return n.jsxs("div",{className:v("",a),children:[n.jsxs("label",{className:"mb-2 block font-bold",children:[g,":"," ",n.jsx("span",{className:"font-base",children:((i=t==null?void 0:t[l])==null?void 0:i.name)||l})]}),n.jsx("div",{className:"flex flex-wrap gap-3",children:e.map(s=>{var S,I;const d=l===s,h=o(s),b=u(s),w=m(s);return n.jsxs("button",{type:"button",onClick:()=>r(s),style:w?b:void 0,className:v("relative h-10 w-10 rounded-full border-2 transition-all hover:scale-105",w?"bg-cover bg-center":h,d?"border-gray-900 ring-2 ring-gray-900 ring-offset-2":"border-gray-200 hover:border-gray-300"),title:((S=t==null?void 0:t[s])==null?void 0:S.name)||s,children:[n.jsx("span",{className:"sr-only",children:((I=t==null?void 0:t[s])==null?void 0:I.name)||s}),d&&w&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsx("svg",{className:"h-4 w-4 text-white drop-shadow-md",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},s)})})]})}function V({variants:g,options:l,initialVariantId:e,onVariantChange:r,onImageChange:a}){const[t,o]=f.useState({});f.useEffect(()=>{const i=g.find(s=>s.id===e);if(i&&l.length>0){const s={};l.forEach((d,h)=>{i.options[h]&&(s[d.name]=i.options[h])}),o(s),a&&i.images&&a(i.images)}},[e,g,l,a]);const u=(i,s)=>{const d={...t,[i]:s};o(d);const h=m(d);h&&(r(h.id,h),a&&h.images&&a(h.images))},m=i=>g.find(s=>l.every((d,h)=>{const b=i[d.name];return s.options[h]===b})),c=i=>i.toLowerCase().includes("color")||i.toLowerCase().includes("colour");return l.length<=0||g.length<=0?null:n.jsx("div",{className:"variant-selectors space-y-6",children:l.map(i=>{const s=t[i.name]||i.values[0];return c(i.name)?n.jsx(R,{label:i.name,selectedValue:s,options:i.values,onSelect:d=>u(i.name,d),colorConfig:i.color_config,className:"w-full"},i.name):n.jsx(U,{label:i.name,selectedValue:s,options:i.values,onSelect:d=>u(i.name,d),className:"w-full"},i.name)})})}class E extends C{connectedCallback(){super.connectedCallback();try{const l=parseInt(this.getAttribute("data-initial-variant-id")||"0",10),e=this.getAttribute("data-variants")||"[]",r=this.getAttribute("data-options")||"[]",a=JSON.parse(e),t=JSON.parse(r),o=(m,c)=>{console.log("Variant changed:",{variantId:m,variant:c});const i=new URL(window.location.href);i.searchParams.set("variant",m.toString()),window.history.replaceState({},"",i.toString());const s=document.querySelector("[data-product-price]");if(s){const h=parseFloat(c.price)/100,b=new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:h%1===0?0:2,maximumFractionDigits:2}).format(h);s.textContent=b}const d=new CustomEvent("variant:changed",{detail:{variantId:m,variant:c},bubbles:!0});this.dispatchEvent(d)},u=m=>{const c=new CustomEvent("gallery:updateImages",{detail:{images:m},bubbles:!0});document.dispatchEvent(c)};this.renderReact(n.jsx(V,{variants:a,options:t,initialVariantId:l,onVariantChange:o,onImageChange:u}))}catch(l){console.error("Error initializing variant selector:",l)}}}y(E,"elementName","variant-selector");customElements.define(E.elementName,E);j.initialize(".gallery-modal-carousel");
